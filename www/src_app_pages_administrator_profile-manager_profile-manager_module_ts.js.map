{"version":3,"file":"src_app_pages_administrator_profile-manager_profile-manager_module_ts.js","mappings":"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","sources":["./src/app/pages/administrator/profile-manager/profile-manager-routing.module.ts","./src/app/pages/administrator/profile-manager/profile-manager.module.ts","./src/app/pages/administrator/profile-manager/profile-manager.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ProfileManagerPage } from './profile-manager.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ProfileManagerPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ProfileManagerPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ProfileManagerPageRoutingModule } from './profile-manager-routing.module';\n\nimport { ProfileManagerPage } from './profile-manager.page';\nimport { SharedModule } from 'src/app/shared/shared.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    SharedModule,\n    ReactiveFormsModule,\n    ProfileManagerPageRoutingModule,\n    SharedModule\n  ],\n  declarations: [ProfileManagerPage]\n})\nexport class ProfileManagerPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { User, userFormData } from 'src/app/core/models/user';\nimport { AlertsService } from 'src/app/shared/utilities/alerts';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { FirebaseAuthService } from 'src/app/core/services/firebase.service';\nimport { VerificationFuncService } from 'src/app/shared/utilities/verificationFunc';\nimport { attachmentOptions, UserPhoto } from 'src/app/core/models/images';\nimport { AttachmentsService } from 'src/app/shared/utilities/attachments.service';\nimport { ImageUploaderService } from 'src/app/core/services/image-uploader.service';\n\n@Component({\n  selector: 'app-profile-manager',\n  templateUrl: './profile-manager.page.html',\n  styleUrls: ['./profile-manager.page.scss'],\n})\nexport class ProfileManagerPage implements OnInit {\n  loading = false;\n  edit = false;\n  defaultUser = '../../../../assets/profile/ProfileBlank.png';\n  newImage;\n  progress=0;\n\n  user: User;\n  userData: userFormData;\n\n  registerForm: FormGroup;\n  validationMessages\n\n  constructor(\n    private router: Router,\n    private alerts: AlertsService,\n    private upload: ImageUploaderService,\n    private images: AttachmentsService,\n    private formBuilder: FormBuilder,\n    private auth: FirebaseAuthService,\n    private verification: VerificationFuncService,\n  ) { }\n\n  ngOnInit() {\n    this.validationMessages = {\n      name:[ {type: 'required', message: ' Escribe tu nombre'},],\n      lastName:[ {type: 'required', message: ' Escribe tu apellido'},],\n      birthday:[ {type: 'required', message: ' Ingresa tu fecha de nacimiento'},]\n    };\n    this.registerForm = this.formBuilder.group({\n      name:[null, { validators: [Validators.required, Validators.minLength(2)] }],\n      lastName:[null, { validators: [Validators.required, Validators.minLength(3)] }],\n      birthday:[null, { validators: [Validators.required] }]\n    });\n    this.checkUser().then(ok => {\n      this.images.loadSaved().then((attachment: any) => {\n        if (attachment.length && attachment[0].deploy){\n          this.changeProfileImage(attachment[0]);\n        }\n      });\n    });\n  }\n\n  EnterSubmit(evt, form){\n    this.verification.EnterSubmit(evt,form,this.loading).then(answer => {\n      if(answer){ console.log('Enter') }\n    })\n  }\n\n  checkUser() {\n    return new Promise((resolve, reject) => {\n      this.loading = true;\n      this.auth.checkUser().then((user: any) =>{\n        this.user = user.user;\n        this.userData = user.data;\n        this.loading = false;\n      }).catch(error => {\n        console.log(error);\n        this.loading = false;\n      });\n    })\n  }\n\n  editForm(){\n    if(!this.edit){\n      this.edit = !this.edit;\n      this.registerForm = this.formBuilder.group({\n        name:[this.userData.name, { validators: [Validators.required, Validators.minLength(2)] }],\n        lastName:[this.userData.lastName, { validators: [Validators.required, Validators.minLength(3)] }],\n        birthday:[this.userData.birthDate, { validators: [Validators.required] }]\n      });\n    } else {\n      const newValues = this.registerForm.value;\n      const nameCheck = this.userData.name !== newValues.name;\n      const lastNameCheck = this.userData.lastName !== newValues.lastName;\n      const birthDateCheck = this.userData.birthDate !== newValues.birthday;\n      if(nameCheck || lastNameCheck || birthDateCheck) {\n        this.loading = true;\n        this.auth.uploadUserForm(this.user.uid,newValues.name,newValues.lastName,newValues.birthday)\n        .then(ok => { \n          this.edit = !this.edit;\n          this.alerts.showAlert('PERFIL','Tus datos han sido actualizados','OK');\n          this.checkUser();\n          this.loading = false;\n        })\n      } else{\n        this.edit = !this.edit;\n      }\n    }\n  }\n\n  // IMAGE SYSTEM\n  addPhoto() {\n    const options: attachmentOptions = {\n      currentRoute: 'manager/profile',\n      height:null, width:null, pdf: false\n    }\n    this.images.presentImageOptions(options).then(imageObj => {\n      if (imageObj[0] !== undefined){\n        this.changeProfileImage(imageObj[0]);\n      }\n    });\n  }\n\n  changeProfileImage(image: UserPhoto){\n    this.loading = true;\n    this.newImage = image;\n    const imageName = Date().toString()+'_'+this.user.uid;\n    this.upload.uploadFile('profile',imageName, image.file,\n    (progress)=>{ this.progress = progress })\n    .then((data:any) => {\n      this.auth.updateUser(this.user.displayName,data.url).then(done => {\n        this.alerts.showAlert('PERFIL','Tus imagen de perfil ha sido actualizada','OK');\n        this.upload.deletePicture();\n        this.newImage = null;\n        this.checkUser();\n        this.loading = false;\n      })\n    })\n  }\n\n  upgradeProfile(){\n    this.loading = true;\n    this.auth.upgradeUser().then((done: any) => {\n      this.alerts.showAlert('PERFIL',done,'OK');\n      this.checkUser();\n      this.loading = false;\n    })\n  }\n\n}\n"],"names":[],"sourceRoot":"webpack:///"}